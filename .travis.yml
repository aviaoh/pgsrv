language: go

branches:
  only:
    - master

go:
  - 1.8.3

install:
  - go get -u github.com/golang/lint/golint
  - go get github.com/lfittl/pg_query_go
  - export PATH=$PATH:$HOME/.local/bin

script:
  - go tool vet .
  - golint -set_exit_status ./...
  - gofmt -l . | exit $(wc -l)
  - go test -v ./... -cover -race

notifications:
  slack:
    rooms:
        - panoplyio:LeK4hoOIDsRiBBAhgXKnSAD0#builds
    on_pull_requests: false
    on_success: change
    on_failure: always
  email:
    recipients:
      - hackers@panoply.io
    on_success: change
    on_failure: always
